<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Guessing Game</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="game">
        <h1>Word Guessing Game</h1>
        <p>Guess the word by typing in the text field below:</p>
        <input type="text" id="guess" autocomplete="off" onkeypress="handleKeyPress(event)">
        <button onclick="checkGuess()">Guess</button>
        <div id="ranking"></div>
        <div id="error"></div>
        <div id="previous-guesses"></div>
    </div>
    <script>
        let rankings;
        let targetWord;

        fetch('ranking.json')
            .then(response => response.json())
            .then(data => {
                rankings = data;
                // Find the word with rank 1
                targetWord = Object.keys(rankings).find(word => rankings[word] === 1);
                if (!targetWord) {
                    throw new Error('No word found with rank 1.');
                }
            })
            .catch(error => {
                const errorDiv = document.getElementById('error');
                errorDiv.textContent = `Error loading rankings: ${error.message}`;
            });

        function checkGuess() {
            const guess = document.getElementById('guess').value;
            const rankingDiv = document.getElementById('ranking');
            const errorDiv = document.getElementById('error');
            const previousGuessesDiv = document.getElementById('previous-guesses');
            
            rankingDiv.innerHTML = '';
            errorDiv.innerHTML = '';

            if (!rankings) {
                errorDiv.textContent = 'Rankings are not loaded yet. Please try again later.';
                return;
            }

            if (!(guess in rankings)) {
                errorDiv.textContent = `The word "${guess}" is not in the rankings.`;
                return;
            }

            if (!targetWord || !(targetWord in rankings)) {
                errorDiv.textContent = `The target word is not in the rankings.`;
                return;
            }

            const rank = rankings[guess];

            const rankingMsg = document.createElement('div');
            rankingMsg.className = 'ranking';
            rankingMsg.textContent = `Your guess is ranked ${rank} in similarity to the target word.`;
            rankingDiv.appendChild(rankingMsg);

            if (guess === targetWord) {
                alert('Congratulations! You guessed the word.');
            }

            // Append the guess to the previous guesses list
            const guessContainer = document.createElement('div');
            guessContainer.className = 'guess-container';

            const guessWord = document.createElement('div');
            guessWord.textContent = guess;

            const guessBar = document.createElement('div');
            guessBar.className = 'guess-bar';
            guessBar.style.width = `${(1 - (rank / Object.keys(rankings).length)) * 100}%`;
            const rankSpan = document.createElement('span');
            rankSpan.textContent = rank;
            guessBar.appendChild(rankSpan);

            guessContainer.appendChild(guessWord);
            guessContainer.appendChild(guessBar);

            previousGuessesDiv.appendChild(guessContainer);
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                checkGuess();
            }
        }
    </script>
</body>
</html>
